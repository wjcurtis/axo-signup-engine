<!doctype html>

<html lang="en" data-theme="light">

<head>

<meta charset="utf-8"/>

<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>AXO Utility Hub</title>

<style>

  :root{

    --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#94a3b8; --accent:#2563eb; --card:#0b1220;

    --shadow:0 10px 30px rgba(0,0,0,.35);

  }

  [data-theme="light"]{ --bg:#f8fafc; --panel:#ffffff; --text:#0f172a; --muted:#475569; --card:#ffffff; }



  html,body{height:100%}

  body{margin:0;background:linear-gradient(160deg,var(--bg),#0b1220);

       font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:var(--text)}

  .wrap{width:min(900px,92vw); margin:0 auto; padding-top:70px;}



  /* Sticky header so buttons are always visible */

  .header{

    position:fixed; top:0; left:0; right:0; height:56px;

    display:flex; align-items:center; justify-content:space-between;

    padding:0 16px; background:rgba(17,24,39,.85); backdrop-filter:saturate(150%) blur(6px);

    color:var(--text); z-index:9999; border-bottom:1px solid rgba(255,255,255,.06);

  }

  .h-left,.h-right{display:flex; gap:10px; align-items:center;}

  .h-btn{display:inline-flex; align-items:center; gap:8px; font-weight:700; padding:8px 12px;

         border-radius:12px; border:1px solid rgba(255,255,255,.2); background:transparent; color:var(--text); cursor:pointer}

  .h-btn:hover{background:rgba(255,255,255,.08)}

  .h-rocket{font-size:20px; padding:8px 12px}



  .title{text-align:center; margin-top:4px}

  .title h1{font-size:46px; margin:8px 0 0}

  .title h2{font-size:18px; margin:4px 0 6px; color:var(--muted)}

  .marker{text-align:center;color:var(--muted);font-size:12px;margin-bottom:8px}



  .panel{background:var(--panel); border-radius:14px; box-shadow:var(--shadow); padding:18px}

  .steps{display:grid; gap:12px; margin-top:16px}

  .step{background:var(--card); border-radius:12px; padding:16px; border:1px solid rgba(125,125,125,.15)}

  .step h3{margin:0 0 8px; font-size:16px}

  .fields input{width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(125,125,125,.25); background:transparent; color:var(--text)}

  .btn{appearance:none;border:0;padding:10px 14px;border-radius:10px;background:var(--accent);color:#fff;cursor:pointer;font-weight:700}

  .btn:disabled{opacity:.6;cursor:not-allowed}

  .ghost{background:transparent;color:var(--text);border:1px solid rgba(125,125,125,.3)}

  .row{display:flex;gap:10px;align-items:center;justify-content:center}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}

  .center{text-align:center}

  small.muted{color:var(--muted)}

  .banner{margin:10px 0 0;padding:10px;border-radius:8px;background:rgba(245,158,11,.12);color:#fbbf24;display:none}

</style>

</head>

<body>

  <div class="header">

    <div class="h-left">

      <button id="themeToggle" class="h-btn" title="Toggle light/dark">ðŸŒ— <span>Theme</span></button>

    </div>

    <div class="h-right">

      <button id="rocket" class="h-btn h-rocket" title="Admin">ðŸš€</button>

    </div>

  </div>



  <div class="wrap">

    <div class="title">

      <h1>AXO</h1>

      <h2>XRPL Signup & Referral Engine</h2>

    </div>

    <div class="marker">GMODE Bv3</div>



    <div id="banner" class="banner"></div>



    <div class="panel">

      <div class="steps">



        <div class="step">

          <h3>1. Connect XUMM Wallet</h3>

          <div class="fields">

            <input id="xrpl" placeholder="Enter your XRPL r-address (r...)" />

          </div>

          <div class="row" style="margin-top:10px;">

            <small class="muted">Weâ€™ll verify your wallet and prepare your bonus.</small>

          </div>

        </div>



        <div class="step">

          <h3>2. Set AXO Trust Line</h3>

          <div class="row">

            <button class="btn ghost" id="trustBtn">Open in XUMM</button>

            <small class="muted">Required before claiming bonus.</small>

          </div>

        </div>



        <div class="step">

          <h3>3. Claim Signup Bonus</h3>

          <div class="grid2">

            <input id="ref" placeholder="Referral code (optional r...)" />

            <button class="btn" id="claimBtn">Claim 1000 AXO</button>

          </div>

          <small class="muted">Referral reward: 300 AXO (auto when referral is valid).</small>

        </div>



        <div class="step">

          <h3>4. Purchase AXO with XRP (optional)</h3>

          <div class="row">

            <button class="btn ghost" id="buyBtn">Open Purchase Flow</button>

          </div>

        </div>



      </div>



      <div class="step">

        <h3>Live Market Data</h3>

        <div id="mkt" class="center">

          <div>AXO Price (USD): <strong id="axo_usd">loadingâ€¦</strong></div>

          <div>XRP Price (USD): <strong id="xrp_usd">loadingâ€¦</strong></div>

          <div>1 XRP = <strong id="axo_per_xrp">loadingâ€¦</strong> AXO</div>

          <small class="muted" id="mkt_src"></small>

        </div>

      </div>

    </div>



    <div class="center" style="margin-top:10px;">

      <small class="muted">Â© AXO</small>

    </div>

  </div>



<script>

(function(){

  // Theme toggle

  const root = document.documentElement;

  const saved = localStorage.getItem('theme');

  if (saved) root.setAttribute('data-theme', saved);

  document.getElementById('themeToggle').onclick = () => {

    const t = root.getAttribute('data-theme') === 'light' ? 'dark' : 'light';

    root.setAttribute('data-theme', t); localStorage.setItem('theme', t);

  };



  // Rocket â†’ /admin (server will ask for PIN)

  document.getElementById('rocket').onclick = (e)=>{ e.preventDefault(); location.href='/admin'; };



  async function loadConfig(){

    try{

      const r = await fetch('/api/admin/config');

      if (!r.ok) return;

      const cfg = await r.json();

      if (cfg.banner){

        const b = document.getElementById('banner'); b.textContent = cfg.banner; b.style.display='block';

      }

      if (typeof cfg.signup_bonus === 'number'){

        document.getElementById('claimBtn').textContent = `Claim ${cfg.signup_bonus} AXO`;

      }

    }catch(e){}

  }



  async function loadMarket(){

    try{

      const r = await fetch('/api/market',{cache:'no-store'});

      const m = await r.json();

      const set=(id,v)=>document.getElementById(id).textContent=v;

      set('axo_usd',(m.axo_usd??0).toFixed(4));

      set('xrp_usd',(m.xrp_usd??0).toFixed(4));

      set('axo_per_xrp',(m.axo_per_xrp??0).toLocaleString());

      document.getElementById('mkt_src').textContent=`Source ${m.source||'â€”'} â€¢ ${new Date((m.ts||0)*1000).toLocaleTimeString()}`;

    }catch(e){}

  }

  loadConfig(); loadMarket(); setInterval(loadMarket,30000);



  // Demo stubs

  document.getElementById('trustBtn').onclick = ()=> alert('Would open XUMM TrustLine (demo).');

  document.getElementById('buyBtn').onclick   = ()=> alert('Would open purchase flow (demo).');

  document.getElementById('claimBtn').onclick = async ()=>{

    const xrpl=document.getElementById('xrpl').value.trim();

    const ref =document.getElementById('ref').value.trim();

    if(!xrpl) return alert('Please enter your XRPL r-address.');

    const r = await fetch('/api/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({xrpl,ref})});

    const j = await r.json(); if(!j.ok) return alert(j.error||'Signup failed.');

    const r2= await fetch('/api/claim-bonus',{method:'POST'}); const j2=await r2.json();

    alert(j2.ok?`âœ… Claimed ${j2.awarded} AXO (demo).`:'Claim failed.');

  };

})();

</script>

</body>

</html>
